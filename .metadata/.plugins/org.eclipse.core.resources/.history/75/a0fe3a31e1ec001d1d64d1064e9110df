/*
 * SONAR.c
 *
 *  Created on: May 7, 2023
 *      Author: Umaar
 */

#include "IfxPort.h"
#include "Bsp.h"

#define ECHO         &MODULE_P14,0      /* Echo Pin P14_0 */
#define TRIG         &MODULE_P14,1      /* Trig Pin P14_1 */

#define PULSE_TIME   10                 /* 10ms */

void SONAR_INIT(void){
    IfxPort_setPinModeOutput(TRIG, IfxPort_OutputMode_pushPull, IfxPort_OutputIdx_general);
    IfxPort_setPinModeInput(ECHO, IfxPort_OutputMode_pushPull, IfxPort_OutputIdx_general);
}

void SONAR_TRIG(void){
    Ifx_TickTime pulse_ticks = IfxStm_getTicksFromMilliseconds(BSP_DEFAULT_TIMER, PULSE_TIME);

    /* set the Trig pin high for at least 10 microseconds, and then set it low again. */
    IfxPort_setPinHigh(TRIG);
    waitTime(pulse_ticks);
}



