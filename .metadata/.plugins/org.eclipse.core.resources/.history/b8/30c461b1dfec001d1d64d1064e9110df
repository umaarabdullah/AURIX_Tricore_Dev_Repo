/*
 * SONAR.c
 *
 *  Created on: May 7, 2023
 *      Author: Umaar
 */

#include "IfxPort.h"
#include "Bsp.h"

#define ECHO         &MODULE_P14,0      /* Echo Pin P14_0 */
#define TRIG         &MODULE_P10,1      /* Trig Pin P14_1 */

#define PULSE_TIME   2000

void SONAR_INIT(void){
    IfxPort_setPinModeOutput(TRIG, IfxPort_OutputMode_pushPull, IfxPort_OutputIdx_general);
    IfxPort_setPinModeOutput(ECHO, IfxPort_OutputMode_pushPull, IfxPort_OutputIdx_general);
//    IfxPort_setPinModeInput(ECHO, IfxPort_OutputMode_pushPull, IfxPort_OutputIdx_general);
}

void SONAR_TEST(void){
    Ifx_TickTime pulse_ticks = IfxStm_getTicksFromMilliseconds(BSP_DEFAULT_TIMER, PULSE_TIME);

    IfxPort_setPinLow(ECHO);
    waitTime(pulse_ticks);
    IfxPort_setPinLow(TRIG);
    waitTime(pulse_ticks);
    IfxPort_setPinHigh(ECHO);
    waitTime(pulse_ticks);
    IfxPort_setPinHigh(TRIG);
    waitTime(pulse_ticks);
}



